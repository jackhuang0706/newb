<!DOCTYPE html>
<html lang="zh-TW" dir="ltr" class="h-full">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>LeetCode 1681. Minimum Incompatibility | Fijjj&#39;s Lazy Life</title>


<meta name="color-scheme" content="light dark">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b1220">
<script>
  (function() {
    try {
      var t = localStorage.getItem('theme');
      var dark = t ? (t === 'dark') : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
      if (dark) document.documentElement.classList.add('dark');
    } catch (_) {}
  })();
  </script>
<style>
   
  html.dark, html.dark body { background-color: #0b1220; }
  html { color-scheme: light dark; }
  </style>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>


<link rel="dns-prefetch" href="//busuanzi.ibruce.info">
<link rel="preconnect" href="https://busuanzi.ibruce.info" crossorigin>


<link rel="icon" type="image/png" href='/newb/favicon/favicon-96x96.png' sizes="96x96" />
<link rel="icon" type="image/svg+xml" href='/newb/favicon/favicon.svg' />
<link rel="shortcut icon" href='/newb/favicon/favicon.ico' />
<link rel="apple-touch-icon" sizes="180x180" href='/newb/favicon/apple-touch-icon.png' />
<link rel="manifest" href='/newb/favicon/site.webmanifest' />



  
  
    
    
      
        
          <link rel="stylesheet" href="/newb/css/main.13d3fe586b961324d829fc27d7302d2d6719cd890dd53fc4b58505c2d9779ab3.css" integrity="sha256-E9P&#43;WGuWEyTYKfwn1zAtLWcZzYkN1T/EtYUFwtl3mrM=" crossorigin="anonymous">
        
      
    
  





<link rel="stylesheet" href="/newb/css/style.min.b8957659e8f2f20e0a23b5cc1f1154837f41cca9f5570fd8f30cd1c087568650.css" media="screen" integrity="sha256-uJV2Wejy8g4KI7XMHxFUg39BzKn1Vw/Y8wzRwIdWhlA=">


<link id="hljs-theme-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
<link id="hljs-theme-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
<script>
  (function(){
    try{
      var t = localStorage.getItem('theme');
      var dark = t ? (t === 'dark') : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
      var l = document.getElementById('hljs-theme-light');
      var d = document.getElementById('hljs-theme-dark');
      if(l && d){ l.disabled = dark; d.disabled = !dark; }
    }catch(e){}
  })();
  </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>


<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">

  
      <script src="/newb/js/main.3590efd59d4d3b0c802b8f46fac9c42cf893d10d7894b51073bad78a48b82463.js" integrity="sha256-NZDv1Z1NOwyAK49G&#43;snELPiT0Q14lLUQc7rXiki4JGM=" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>


<script>
  document.addEventListener('DOMContentLoaded', function() {
    
    renderMathInElement(document.body, {
      delimiters: [
        {left: "$$", right: "$$", display: true},
        {left: "$", right: "$", display: false}
      ],
      throwOnError: false
    });
    
    
    document.querySelectorAll('pre code').forEach(function(codeBlock) {
      
      let language = '';
      codeBlock.className.split(' ').forEach(function(cls) {
        if (cls.startsWith('language-')) {
          language = cls.substring(9);
        }
      });
      
      
      const pre = codeBlock.parentNode;
      const wrapper = pre.parentNode;
      
      
      const container = document.createElement('div');
      container.className = 'code-block-container';
      
      
      const header = document.createElement('div');
      header.className = 'code-block-header';
      
      
      if (language) {
        const langLabel = document.createElement('span');
        langLabel.className = 'code-language-label';
        langLabel.textContent = language.toUpperCase();
        header.appendChild(langLabel);
      }
      
      
      const copyButton = document.createElement('button');
      copyButton.className = 'copy-button';
      copyButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" /></svg> Copy';
      
      copyButton.addEventListener('click', function() {
        
        const code = codeBlock.textContent;
        
        
        navigator.clipboard.writeText(code).then(function() {
          
          copyButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg> Copied!';
          
          
          setTimeout(function() {
            copyButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" /></svg> Copy';
          }, 2000);
        });
      });
      
      header.appendChild(copyButton);
      
      container.appendChild(header);
      
      if (pre.parentNode) {
        pre.parentNode.replaceChild(container, pre);
      }
      container.appendChild(pre);
      
      
      if (window.hljs) hljs.highlightElement(codeBlock);
    });
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    
    const footnoteBacklinks = document.querySelectorAll('.footnote-backref');
    
    footnoteBacklinks.forEach(function(backlink) {
      backlink.addEventListener('click', function(e) {
        e.preventDefault();
        
        
        const href = backlink.getAttribute('href');
        
        if (href) {
          
          const target = document.querySelector(href);
          
          if (target) {
            
            target.scrollIntoView({ behavior: 'smooth' });
            
            
            target.classList.add('footnote-highlight');
            setTimeout(function() {
              target.classList.remove('footnote-highlight');
            }, 2000);
          }
        }
      });
    });
  });
</script>


<script>
  document.addEventListener('DOMContentLoaded', function () {
    
    (function themeInit() {
      const storageKey = 'theme';
      const root = document.documentElement;
      const btn = document.getElementById('theme-toggle');
      const hlLight = document.getElementById('hljs-theme-light');
      const hlDark = document.getElementById('hljs-theme-dark');

      function systemPrefersDark() {
        return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      }

      function currentPref() {
        const v = localStorage.getItem(storageKey);
        if (v === 'dark') return 'dark';
        if (v === 'light') return 'light';
        return systemPrefersDark() ? 'dark' : 'light';
      }

      function apply(theme) {
        root.classList.toggle('dark', theme === 'dark');
        if (btn) btn.setAttribute('aria-pressed', theme === 'dark' ? 'true' : 'false');
        if (btn) btn.setAttribute('aria-label', theme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode');
        if (hlLight && hlDark) { hlLight.disabled = theme === 'dark'; hlDark.disabled = theme !== 'dark'; }
      }

      let theme = currentPref();
      apply(theme);

      if (btn) {
        btn.addEventListener('click', function () {
          theme = theme === 'dark' ? 'light' : 'dark';
          localStorage.setItem(storageKey, theme);
          apply(theme);
        });
      }

      
      try {
        const media = window.matchMedia('(prefers-color-scheme: dark)');
        const handler = function () {
          const explicit = localStorage.getItem(storageKey);
          if (!explicit) { theme = currentPref(); apply(theme); }
        };
        if (media && media.addEventListener) media.addEventListener('change', handler);
        else if (media && media.addListener) media.addListener(handler);
      } catch (_) {}
    })();
    let currentHighlighted = null;
    let scrollArmTimer = null;

    function removeHandlers() {
      window.removeEventListener('scroll', clearOnce);
      window.removeEventListener('keydown', clearOnce);
      window.removeEventListener('pointerdown', clearOnce);
      window.removeEventListener('touchstart', clearOnce);
    }

    function clearOnce() {
      if (currentHighlighted) {
        currentHighlighted.classList.remove('anchor-highlight');
        currentHighlighted = null;
      }
      removeHandlers();
    }

    function headerHeight() {
      const hd = document.querySelector('body > header');
      return hd ? hd.getBoundingClientRect().height : 0;
    }

    function scrollToTarget(el) {
      if (!el) return;
      const offset = headerHeight() + 8; 
      const rect = el.getBoundingClientRect();
      const top = window.pageYOffset + rect.top - offset;
      window.scrollTo({ top, behavior: 'smooth' });
    }

    function pickHighlightTarget(el) {
      if (!el) return null;
      
      
      if (el.tagName === 'IMG') return el;
      
      if (el.classList && (el.classList.contains('katex-display') || el.classList.contains('katex'))) return el;
      
      if (el.tagName === 'SPAN') {
        const img = el.querySelector('img');
        if (img) return img;
        const kx = el.querySelector('.katex-display, .katex');
        if (kx) return kx;
        
        return el;
      }
      
      const head = el.closest('h1,h2,h3,h4,h5,h6');
      if (head) return head;
      
      const code = el.closest('.code-block-container');
      if (code) return code;
      
      const math = el.closest('.katex-display');
      if (math) return math;
      
      const blk = el.closest('pre,figure,table,blockquote,li');
      if (blk) return blk;
      
      if (el.closest('p')) return el;
      return el;
    }

    function highlightById(id) {
      if (!id) return;
      try { id = decodeURIComponent(id); } catch (e) {}
      const el = document.getElementById(id);
      if (!el) return;
      const target = pickHighlightTarget(el);
      if (currentHighlighted && currentHighlighted !== target) {
        currentHighlighted.classList.remove('anchor-highlight');
      }
      target.classList.add('anchor-highlight');
      currentHighlighted = target;
      
      setTocActive(id);
      scrollToTarget(target);
      
      removeHandlers();
      
      window.addEventListener('keydown', clearOnce, { once: true });
      window.addEventListener('pointerdown', clearOnce, { once: true });
      window.addEventListener('touchstart', clearOnce, { once: true });
      if (scrollArmTimer) clearTimeout(scrollArmTimer);
      scrollArmTimer = setTimeout(() => {
        window.addEventListener('scroll', clearOnce, { once: true });
      }, 1500);
    }

    
    if (location.hash && location.hash.length > 1) {
      
      setTimeout(() => highlightById(location.hash.slice(1)), 0);
    }

    
    window.addEventListener('hashchange', function () {
      if (location.hash && location.hash.length > 1) {
        highlightById(location.hash.slice(1));
      }
    });

    
    document.addEventListener('click', function (e) {
      const a = e.target.closest('a[href^="#"]');
      if (!a) return;
      
      if (a.classList && a.classList.contains('heading-anchor')) return;
      const href = a.getAttribute('href');
      if (!href || href === '#' || href.length < 2) return;
      const id = href.slice(1);
      if (!document.getElementById(id)) return; 
      e.preventDefault();
      if (history.pushState) { history.pushState(null, '', '#' + id); }
      else { location.hash = id; }
      highlightById(id);
    }, true);

    
    window.addEventListener('popstate', function () {
      if (location.hash && location.hash.length > 1) highlightById(location.hash.slice(1));
    });

    function setTocActive(id) {
      try { id = decodeURIComponent(id); } catch (e) {}
      const toc = document.getElementById('TableOfContents');
      if (!toc) return;
      const esc = (window.CSS && CSS.escape) ? CSS.escape : (s)=>String(s).replace(/[^a-zA-Z0-9_\-]/g, '\\$&');
      toc.querySelectorAll('a.toc-active').forEach(a => a.classList.remove('toc-active'));
      const link = toc.querySelector('a[href="#' + esc(id) + '"]');
      if (link) link.classList.add('toc-active');
    }

    
    function copyText(text) {
      if (window.isSecureContext && navigator.clipboard && navigator.clipboard.writeText) {
        return navigator.clipboard.writeText(text);
      }
      return new Promise(function (resolve, reject) {
        try {
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.setAttribute('readonly', '');
          ta.style.position = 'fixed'; ta.style.top = '-1000px'; ta.style.left = '-1000px'; ta.style.opacity = '0';
          document.body.appendChild(ta);
          ta.focus(); ta.select();
          try { ta.setSelectionRange(0, ta.value.length); } catch (_) {}
          const ok = document.execCommand && document.execCommand('copy');
          document.body.removeChild(ta);
          ok ? resolve() : reject(new Error('copy failed'));
        } catch (e) { reject(e); }
      });
    }

    
    (function addHeadingAnchorCopy() {
      const container = document.querySelector('article .prose');
      if (!container) return;
      const heads = container.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
      heads.forEach((h) => {
        const id = h.getAttribute('id');
        if (!id) return;
        let a = h.querySelector('.heading-anchor');
        if (!a) {
          a = document.createElement('a');
          a.className = 'heading-anchor';
          a.href = '#' + id;
          a.setAttribute('aria-label', 'Copy link to this section');
          a.innerHTML = '<svg viewBox="0 0 1024 1024" width="18" height="18" fill="currentColor" aria-hidden="true"><path d="M633.417143 429.007238a174.567619 174.567619 0 0 1 0 246.857143l-155.306667 155.306667a186.709333 186.709333 0 1 1-264.045714-264.045715l76.483048-76.507428 51.73638 51.736381-76.507428 76.507428a113.566476 113.566476 0 1 0 160.597333 160.597334l155.306667-155.306667a101.424762 101.424762 0 0 0 0-143.408762z m208.603428-225.816381a186.709333 186.709333 0 0 1 0 264.045714L765.561905 543.744l-51.736381-51.712 76.507428-76.507429a113.566476 113.566476 0 1 0-160.597333-160.597333l-155.306667 155.306667a101.424762 101.424762 0 0 0 0 143.408762l-51.736381 51.736381a174.567619 174.567619 0 0 1 0-246.857143l155.306667-155.306667a186.709333 186.709333 0 0 1 264.045714 0z"/></svg>';
          h.appendChild(a);
        }
        function copyPermalink() {
          const url = location.origin + location.pathname + '#' + id;
          const done = function () {
            a.classList.add('copied');
            a.setAttribute('aria-label', 'Copied');
            setTimeout(() => { a.classList.remove('copied'); a.setAttribute('aria-label', 'Copy link to this section'); }, 1200);
          };
          copyText(url).then(done).catch(done);
        }
        a.addEventListener('click', function (e) { e.preventDefault(); e.stopPropagation(); copyPermalink(); });

        
        h.classList.add('heading-clickable');
        h.addEventListener('click', function (e) {
          if (e.target.closest('a') && !e.target.closest('.heading-anchor')) return; 
          copyPermalink();
        });
      });

      
      document.addEventListener('click', function (e) {
        const btn = e.target.closest('a.heading-anchor');
        if (!btn) return;
        
        e.preventDefault(); e.stopPropagation();
        const href = btn.getAttribute('href') || '';
        const id = href.startsWith('#') ? href.slice(1) : '';
        const url = href.startsWith('#') ? (location.origin + location.pathname + href) : href;
        copyText(url).finally(() => {
          btn.classList.add('copied'); btn.setAttribute('aria-label', 'Copied');
          setTimeout(() => { btn.classList.remove('copied'); btn.setAttribute('aria-label', 'Copy link to this section'); }, 1200);
          if (id) {
            try { if (history.pushState) history.pushState(null, '', '#' + id); else location.hash = id; } catch (_) {}
            try { highlightById(id); } catch (_) {}
          }
        });
      }, false);
    })();
  });
</script>




<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</head>
<body class="flex flex-col bg-gray-50 font-bilingual">
  <header class="fixed top-0 left-0 z-30 w-full bg-white shadow-sm">
    <div class="w-full max-w-4xl mx-auto px-6 overflow-x-auto sm:overflow-visible">
      <div class="flex items-center justify-between py-3">
  <div class="text-lg sm:text-xl font-bold flex-shrink-0 max-w-[40%] sm:max-w-md truncate">
    <a href='/newb/' class="no-underline transition-colors text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-300">
      Fijjj&#39;s Lazy Life
    </a>
  </div>
  <div class="flex items-center gap-2">
    
  <nav class="flex justify-end w-full whitespace-nowrap">
    <ul class="list-none flex flex-row items-center space-x-2 sm:space-x-4 md:space-x-6 py-2">
    <li class="text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white text-base sm:text-lg">
      <a
        class="px-2 py-1 sm:px-3 sm:py-2 rounded hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" href="/newb/">Home</a>
    </li>
    <li class="text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white text-base sm:text-lg">
      <a
        class="px-2 py-1 sm:px-3 sm:py-2 rounded hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" aria-current="true" class="ancestor font-semibold" href="/newb/posts/">Posts</a>
    </li>
    <li class="text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white text-base sm:text-lg">
      <a
        class="px-2 py-1 sm:px-3 sm:py-2 rounded hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" href="/newb/tags/">Tags</a>
    </li>
    <li class="text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white text-base sm:text-lg">
      <a
        class="px-2 py-1 sm:px-3 sm:py-2 rounded hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" href="/newb/about/">About</a>
    </li>
    </ul>
  </nav>

    <button id="theme-toggle" type="button" class="theme-toggle theme-toggle-btn ml-2 relative inline-flex h-7 w-7 items-center justify-center p-0 bg-transparent border-0 text-gray-700 dark:text-gray-200 hover:text-blue-600 dark:hover:text-blue-300 focus:outline-none cursor-pointer" aria-label="Toggle dark mode" aria-pressed="false">
      
      <svg class="icon-sun h-full w-full" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M512 192c179.2 0 320 140.8 320 320s-140.8 320-320 320-320-140.8-320-320S332.8 192 512 192M512 128C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128L512 128z" fill="currentColor"></path>
        <path d="M544 416l236.8 0C774.4 403.2 768 384 761.6 371.2L544 371.2 544 416z" fill="currentColor"></path>
        <path d="M544 608l0 44.8 217.6 0c6.4-12.8 12.8-32 19.2-44.8L544 608z" fill="currentColor"></path>
        <path d="M544 723.2 544 768 640 768c25.6-12.8 44.8-25.6 64-44.8L544 723.2z" fill="currentColor"></path>
        <path d="M800 492.8l-256 0 0 44.8 256 0c0-6.4 0-12.8 0-25.6S800 499.2 800 492.8z" fill="currentColor"></path>
        <path d="M544 300.8 704 300.8c-19.2-19.2-38.4-32-64-44.8L544 256 544 300.8z" fill="currentColor"></path>
      </svg>
      
      <svg class="icon-moon h-full w-full" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M512 832c-179.2 0-320-140.8-320-320s140.8-320 320-320 320 140.8 320 320S691.2 832 512 832M512 896c211.2 0 384-172.8 384-384s-172.8-384-384-384S128 300.8 128 512 300.8 896 512 896L512 896zM800 512c0-160-128-288-288-288l0 576C672 800 800 672 800 512zM480 608 243.2 608C249.6 620.8 256 640 262.4 652.8l217.6 0L480 608zM480 416 480 371.2 262.4 371.2C256 384 249.6 403.2 243.2 416L480 416zM480 300.8 480 256 384 256C358.4 268.8 339.2 281.6 320 300.8L480 300.8zM224 537.6l256 0L480 492.8l-256 0c0 6.4 0 12.8 0 19.2S224 524.8 224 537.6zM480 723.2 320 723.2c19.2 19.2 38.4 32 64 44.8l96 0L480 723.2z" fill="currentColor"></path>
      </svg>
    </button>
  </div>
</div>

    </div>
  </header>
  
  <div class="flex-1 flex flex-col min-h-screen pt-24">
    <main class="flex-1 w-full max-w-4xl mx-auto px-6 overflow-x-auto sm:overflow-visible">
      
  <article class="max-w-4xl mx-auto bg-white rounded-lg shadow-md overflow-hidden">
    <header class="p-8 border-b border-gray-100 relative overflow-hidden">
      
      
      
      
      
      <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4 relative">LeetCode 1681. Minimum Incompatibility</h1>
      
      <div class="flex flex-wrap items-center text-sm text-gray-500 gap-4 relative">
        
        
        
        <time datetime="2026-02-04T00:00:00&#43;00:00" class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          2026-02-04
        </time>
        
        
        <span class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          6 min read
        </span>

        
        <span id="busuanzi_container_page_pv" class="inline-flex items-center whitespace-nowrap">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5 text-gray-400 inline-block flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
          </svg><span class="whitespace-nowrap">Page Views <span id="busuanzi_value_page_pv"></span></span>
        </span>
      </div>
    </header>

    
    
    
    
    
    
    
    <div class="px-8 pt-6" x-data="{ open: false }">
      <button
        class="w-full flex items-center justify-between text-sm text-gray-700 dark:text-gray-200 bg-gray-50 dark:bg-slate-800 hover:bg-gray-100 dark:hover:bg-slate-700 border border-gray-200 dark:border-slate-700 rounded-md px-4 py-2 transition-colors"
        @click="open = !open"
        aria-controls="toc-content"
        :aria-expanded="open.toString()"
      >
        <span>Table of Contents</span>
        <svg x-show="!open" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
        </svg>
        <svg x-show="open" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M5 9a1 1 0 000 2h10a1 1 0 100-2H5z" clip-rule="evenodd" />
        </svg>
      </button>
      <div id="toc-content" x-cloak x-show="open" x-transition class="mt-3 border border-gray-100 rounded-md bg-white p-4 text-sm leading-relaxed">
        <div class="prose prose-sm max-w-none">
          <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#solution">Solution</a></li>
        <li><a href="#code">Code</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
      </div>
    </div>
    

    <div class="p-8 prose prose-sm sm:prose lg:prose-lg max-w-none">
      <blockquote>
<ul>
<li><a href="https://leetcode.com/problems/minimum-incompatibility/description/">題目連結</a></li>
<li>Rating: 2389</li>
</ul>
</blockquote>

<h2 id="solution">Solution
  <a class="heading-anchor" href="#solution" aria-label="Copy link to this section">
    <svg viewBox="0 0 1024 1024" width="18" height="18" fill="currentColor" aria-hidden="true">
      <path d="M633.417143 429.007238a174.567619 174.567619 0 0 1 0 246.857143l-155.306667 155.306667a186.709333 186.709333 0 1 1-264.045714-264.045715l76.483048-76.507428 51.73638 51.736381-76.507428 76.507428a113.566476 113.566476 0 1 0 160.597333 160.597334l155.306667-155.306667a101.424762 101.424762 0 0 0 0-143.408762z m208.603428-225.816381a186.709333 186.709333 0 0 1 0 264.045714L765.561905 543.744l-51.736381-51.712 76.507428-76.507429a113.566476 113.566476 0 1 0-160.597333-160.597333l-155.306667 155.306667a101.424762 101.424762 0 0 0 0 143.408762l-51.736381 51.736381a174.567619 174.567619 0 0 1 0-246.857143l155.306667-155.306667a186.709333 186.709333 0 0 1 264.045714 0z"/>
    </svg>
  </a>
</h2>
<p>首先這題 <code>nums</code> 的範圍只到 16，因此先考慮<strong>枚舉</strong>所有可能的分組。這裡使用<strong>Bitmask</strong>作為如何分組的方法。Bitmask 的概念是利用一個數字代表一種狀態（或一種分組），通常是利用其二進制的數字中的每個 01 代表 <strong>選或不選某個數字</strong>，以這題來說如果 <code>nums</code> 長度是 <code>n</code>，則所有狀態可以用 $0$ 到 $2^{n} - 1$ 來表示，其中每個數字的第 <code>i</code> 個位元代表 <code>nums[i]</code> 有沒有包含在這個數字所代表的分組中。舉例來說，若 <code>n = 4</code>，則範圍是 $0$ 到 $15$，若拿 $11$ 來說, $(11)_{10}=(1011)_2$，代表第 $0, 2, 3$ 個元素是包含在這個分組中的（或是反過來看也可以）。透過這種方法可以確保每種狀態都有成功被枚舉且保證每種狀態只會被遍歷一次，避免因順序不同造成同一個狀態被訪問多次而消耗時間。</p>
<p>回到這題，首先先嘗試列舉所有子集合，這題的規定是<strong>所有元素不能重複</strong>，且<strong>子集的元素數量是固定的</strong>，因此在枚舉 $0$ 到 $2^{n} - 1$ 時只考慮 bit 中有特定數量的數字，且確認數字皆不重複後才視為合法的子集合，並將該子集的 <em><strong>incompatibilities</strong></em> 求出。</p>
<p>接著要利用 DP 求出題目要的 <em><strong>minimum possible sum of incompatibilities</strong></em>，定義 <code>dp[i]</code> 為 <code>i</code> 代表的分組型態時的最小 <em><strong>incompatibilities</strong></em>，因為所有數字都必須被分組，因此最終要求的答案是 <code>dp[2ⁿ - 1]</code> （所有元素都被選到）。首先從 $0$ 開始，因為什麼都沒選，因此答案顯然是 0，接著考慮所有組別，嘗試看看是否能與現在的狀態相容並合併，也就是把兩組子集合併（或是已經合併過的子集再與另一個子集合併）並求出最小答案。這裡要先判斷怎麼樣的組別是可以合併的，首先<strong>兩個組別的元素是不能重疊的</strong>，此外，為了避免枚舉數量過多，要嘗試讓每一種組合的合併順序是固定的。舉例，如果有一種分組（不一定是答案）是 $(0, 5), (1, 3), (2, 4)$（數字代表 <code>nums</code> 中第幾個數字），那如果沒有指定順序，合併順序會有非常多種，比如 $(0, 5)$ 可以先和 $(1, 3)$ 合併，但也可以先和 $(2, 4)$ 合併，這會造成轉移數太多。但如果指定好一個順序的話，只需要跑一次，可以省時間。這裡因為狀態由小排到大，因此指定順序的方法使用 <strong>lowbit</strong> 來做，在某一個數字時，先確認該數字<strong>在二進制時最低位的 0</strong>，表示現在缺少的元素中的最後一個，並且指定子集中要具有這個元素才視為合法，這樣可以有效確保合併是朝著一個方向前進的（因為合併後一定含有該元素，不可能再變成 0），用上面的例子，$(0, 5)$ 代表 $100001$、$(1, 3)$ 代表 $010100$、$(2, 4)$ 代表 $001010$，假設現在在一開始 <code>i = 0</code> （$00000\underline{0}$）的時候，如果不加上限制，則三個都是合法的，但若考慮 lowbit，只有 $(0, 5)$ 是合法的。</p>
<p>最後要判斷是否有合法解，只要看 <code>dp[2ⁿ - 1]</code> 是否有被更新過就可以了，因為若不存在合法解，則它是不可能被更新的。</p>
<ul>
<li><strong>Time Complexity:</strong> $\mathcal{O}(3^n)$</li>
<li><strong>Space Complexity:</strong> $\mathcal{O}(2^n)$</li>
</ul>

<h2 id="code">Code
  <a class="heading-anchor" href="#code" aria-label="Copy link to this section">
    <svg viewBox="0 0 1024 1024" width="18" height="18" fill="currentColor" aria-hidden="true">
      <path d="M633.417143 429.007238a174.567619 174.567619 0 0 1 0 246.857143l-155.306667 155.306667a186.709333 186.709333 0 1 1-264.045714-264.045715l76.483048-76.507428 51.73638 51.736381-76.507428 76.507428a113.566476 113.566476 0 1 0 160.597333 160.597334l155.306667-155.306667a101.424762 101.424762 0 0 0 0-143.408762z m208.603428-225.816381a186.709333 186.709333 0 0 1 0 264.045714L765.561905 543.744l-51.736381-51.712 76.507428-76.507429a113.566476 113.566476 0 1 0-160.597333-160.597333l-155.306667 155.306667a101.424762 101.424762 0 0 0 0 143.408762l-51.736381 51.736381a174.567619 174.567619 0 0 1 0-246.857143l155.306667-155.306667a186.709333 186.709333 0 0 1 264.045714 0z"/>
    </svg>
  </a>
</h2>
<pre tabindex="0"><code class="language-python"># Python 3
# Beats 76.47 %
# https://leetcode.com/problems/minimum-incompatibility/submissions/1906596366/

class Solution:
    def minimumIncompatibility(self, nums: List[int], k: int) -&gt; int:
        n = len(nums)

        # construct all valid subsets and calculate the incompatibility
        subsets = {}
        groupSize = n // k
        for i in range(1 &lt;&lt; n):
            if i.bit_count() == groupSize:
                elements = set([nums[j] for j in range(n) if (i &gt;&gt; j) &amp; 1])
                if len(elements) == groupSize:
                    diff = max(elements) - min(elements)
                    subsets[i] = diff
        
        # Bitmask DP
        INF = 10 ** 18
        dp = [INF for _ in range(1 &lt;&lt; n)]
        dp[0] = 0
        for i in range(1 &lt;&lt; n):
            if dp[i] == INF:
                continue
            remain = ((1 &lt;&lt; n) - 1) ^ i
            lowbit = remain &amp; -remain
            for mask, val in subsets.items():
                if (mask &amp; remain) == mask and mask &amp; lowbit:
                    newmask = mask | i
                    dp[newmask] = min(dp[newmask], dp[i] &#43; val)

        res = dp[(1 &lt;&lt; n) - 1]
        return (res if res != INF else -1)</code></pre>
    </div>

    
    
    
    
    <div class="px-8 pb-2 text-sm text-gray-500 flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
      </svg>
      Last updated on 2026-02-04
    </div>
    

    <footer class="px-8 py-6 bg-gray-50 border-t border-gray-100">
      
  <div class="tags-container">
    <div class="text-gray-700 dark:text-gray-300 font-medium mb-2">Tags:</div>
    <div class="flex flex-wrap gap-2">
        <a href="/newb/tags/leetcode/" class="tag-chip inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-50 dark:bg-slate-800 text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-slate-700 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-labelledby="tagIconTitle" role="img">
            <title id="tagIconTitle">Tag</title>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
          </svg>
          LeetCode
        </a>
        <a href="/newb/tags/bitmask-dp/" class="tag-chip inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-50 dark:bg-slate-800 text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-slate-700 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-labelledby="tagIconTitle" role="img">
            <title id="tagIconTitle">Tag</title>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
          </svg>
          Bitmask DP
        </a>
    </div>
  </div>

      
      
      
      
      
      <nav class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
        

        
        <a href="/newb/posts/leetcode-3721/" class="group block p-4 bg-white border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50/30 transition-colors sm:text-right sm:col-start-2">
          <div class="text-xs text-gray-500 mb-1 flex items-center sm:justify-end">
            <span class="sm:order-1 mr-0 sm:ml-1">Next</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1.5 text-gray-400 sm:order-2 sm:ml-1 sm:mr-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
            </svg>
          </div>
          <div class="text-sm font-medium text-gray-900 group-hover:text-blue-700 line-clamp-2">LeetCode 3721. Longest Balanced Subarray II</div>
        </a>
        
      </nav>
      
      
      
      <div class="mt-6 flex justify-center">
        <a href="/" class="inline-flex items-center text-gray-600 hover:text-blue-600 transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          Back to Home
        </a>
      </div>
    </footer>
  </article>

  
  <div class="max-w-4xl mx-auto mt-8 bg-white rounded-lg shadow-md overflow-hidden theme-card" style="--tw-prose-body: #374151; --tw-prose-headings: #111827; --tw-prose-links: #2563eb; --tw-prose-links-hover: #1d4ed8; --tw-prose-code-bg: #f3f4f6; color: #374151;">
    
 
  </div>

    </main>
  </div>
  
  <footer class="w-full max-w-4xl mx-auto px-6 overflow-x-auto sm:overflow-visible">
    <div class="py-8 border-t border-gray-200 bg-gray-50 shadow-inner mt-10">
  <div class="container mx-auto px-4 max-w-4xl">
    
     
     
       
         
       
     
       
         
       
     
       
         
       
    

    
    <div class="flex justify-center space-x-8">
      
      
      <div class="transform transition duration-200 hover:scale-110">
        <a
          href="https://github.com/jackhuang0706"
          target="_blank"
          rel="noopener noreferrer"
          class="text-gray-600 hover:text-gray-900"
          aria-label="GitHub"
        >
          <svg
            class="h-7 w-7"
            fill="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              fill-rule="evenodd"
              d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
              clip-rule="evenodd"
            />
          </svg>
        </a>
      </div>
      

      
      
      <div class="transform transition duration-200 hover:scale-110">
        <a
          href="https://www.linkedin.com/in/jack-huang-a65a5a388/"
          target="_blank"
          rel="noopener noreferrer"
          class="text-gray-600 hover:text-gray-900"
          aria-label="LinkedIn"
        >
          <svg
            class="h-7 w-7"
            fill="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"
            ></path>
          </svg>
        </a>
      </div>
      

      
      
      <div class="transform transition duration-200 hover:scale-110">
        <a
          href="mailto:2007jackhuang@gmail.com"
          rel="noopener noreferrer"
          class="text-gray-600 hover:text-gray-900"
          aria-label="email"
        >
          <svg
            class="h-7 w-7"
            fill="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              d="M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z"
            />
            <path
              d="M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z"
            />
          </svg>
        </a>
      </div>
      
    </div>

    <div class="text-center mt-6 text-sm text-gray-500">
      &copy; 2026 Fijjj&#39;s Lazy Life | Powered by <a href="https://github.com/Daucloud/hugo-theme-void" class="text-gray-600 hover:text-gray-900 hover:underline">hugo-theme-void</a> | <span id="busuanzi_container_site_pv" style="display: none;">Total visits: <span id="busuanzi_value_site_pv" class="text-gray-600"></span></span>
    </div>
    
  </div>
</div>

  </footer>
</body>
</html>
